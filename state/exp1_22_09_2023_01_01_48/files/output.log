---------Parameters---------
root: ~/Datasets
dataset: arxiv
invalidate_cache: False
dataset_len_cap: 510
val_len_cap: 510
test_len_cap: 500
shuffle_index: False
force_cache: False
classification_only: False
early_stopping_patience: 20
reset_after_layer: None
original_features: False
override_log: False
seed: None
metric: Acc
learning_rate: 1e-05
epochs: 1
print_epoch: 10
eval_epoch: 10
checkpoint_epoch: 10
print_step: 2000
eval_step: 100
checkpoint_step: 2000
batch_size: 5
weight_decay: 0.001
dropout: 0
text_features_dropout: 0
rel_sample_random_seed: None
split_train_nodes: False
verbose: False
workers: 10
device: cuda:1
input_dim: 768
emb_dim: 256
gnn_type: sage
n_layer: 1
meta_n_layer: 1
second_gnn: Atten
attention_mask_scheme: causal
skip_path: False
has_final_back: False
layers: S2,U,M
ignore_label_embeddings: True
zero_label_embeddings: False
not_freeze_learned_label_embedding: False
linear_probe: False
fix_datasets_first: False
no_bn_metagraph: False
no_bn_encoder: False
calc_ranks: False
eval_only: True
meta_gnn_pos_only: False
task_name: classification
zero_shot: False
no_split_labels: True
all_test: False
train_cap: 10
label_set: None
csr_split: False
n_way: 3
n_shots: 3
n_query: 3
n_way_upper: -1
n_shots_upper: -1
n_query_upper: -1
max_length: -1
augmentation:
augment_test: False
attr_regression_weight: 0.0
prefix: exp1
timestamp: 22_09_2023_01_01_48
log_dir: log
state_dir: state
bert_emb_model: roberta-base-nli-stsb-mean-tokens
bert_cache: multi-qa-distilbert-cos-v1
kg_emb_model:
pretrained_model_run: ./state/MAG_PT_PRODIGY_04_09_2023_08_59_31/state_dict
small_dataset: False
experiment_type: metagraph
exp_name: exp1_22_09_2023_01_01_48
----------------------------
SingleLayerGeneralGNN(
  (layer_list): ModuleList(
    (0): MultiLayerGNN(
      (module_list): ModuleList(
        (0-1): 2 x SAGEConvSelfLoops()
      )
      (act): ReLU()
      (reset_mlp): Linear(in_features=512, out_features=256, bias=True)
      (reset_mlp_c): Linear(in_features=256, out_features=256, bias=True)
      (reset_mlp_m): Linear(in_features=256, out_features=256, bias=True)
    )
    (1): BgGraphToSupernodePropagator()
    (2): MetaGNN(
      (gnn_layers): ModuleList(
        (0): MetaGNNLayer()
      )
      (gnn_non_linear): GELU(approximate='none')
    )
  )
  (cos): CosineSimilarity()
  (initial_label_mlp): Linear(in_features=768, out_features=256, bias=True)
  (initial_input_mlp): Identity()
  (final_label_mlp): Identity()
  (final_input_mlp): Identity()
  (learned_label_embedding): Embedding(1000, 256)
  (txt_dropout): Dropout(p=0, inplace=False)
)
Number of trainable parameters of the model: 2035522
Reload state dict from path ./state/MAG_PT_PRODIGY_04_09_2023_08_59_31/state_dict
{0: array([  36,   96,  353, 1669, 2668, 2943, 3404, 3912, 4240, 5242]), 1: array([ 186,  193,  200,  374, 1657, 2229, 2357, 2811, 3415, 5310]), 2: array([ 43,  79, 110, 149, 153, 157, 192, 209, 237, 257]), 3: array([  8,  29,  40,  83, 213, 266, 288, 458, 880, 946]), 4: array([  0,   7,  30,  53,  85, 112, 125, 134, 162, 215]), 5: array([  1,  56,  63,  69,  97, 174, 245, 330, 373, 392]), 6: array([   6,  100,  219,  310,  448,  454,  988,  996, 1489, 1658]), 7: array([ 195,  226,  815,  834, 1017, 1331, 1349, 1378, 1446, 1462]), 8: array([  3,  33,  41,  62, 109, 120, 121, 133, 163, 168]), 9: array([ 60,  61,  66, 181, 275, 848, 851, 854, 889, 915]), 10: array([ 32, 101, 104, 129, 146, 224, 230, 235, 246, 290]), 11: array([  87,  144,  251, 1413, 1478, 2204, 2756, 4066, 4069, 4123]), 12: array([28709, 33497, 47486, 49324, 53177, 57175, 65874, 66545, 84236,
       92632]), 13: array([  77,  260,  268,  270,  302, 1375, 1397, 1484, 1504, 1508]), 14: array([  21,  135,  184,  837, 1425, 1491, 2639, 2644, 2670, 2826]), 15: array([1577, 1647, 1746, 2215, 3602, 3928, 4275, 4834, 4917, 5384]), 16: array([ 14,  31,  34,  38,  64,  75, 123, 127, 128, 221]), 17: array([1439, 2178, 2312, 3056, 3615, 4847, 5236, 6122, 6586, 7731]), 18: array([  48,  298, 1008, 1500, 2119, 2631, 2891, 4837, 5213, 5281]), 19: array([ 19,  46,  82, 116, 142, 143, 178, 180, 202, 263]), 20: array([ 42,  59, 211, 242, 269, 423, 439, 446, 819, 883]), 21: array([ 190,  466,  867, 1338, 1421, 1646, 2164, 2652, 2666, 2747]), 22: array([ 13,  35,  45, 115, 148, 161, 225, 243, 402, 441]), 23: array([ 86, 114, 140, 150, 159, 172, 198, 335, 436, 865]), 24: array([ 10,  18,  37,  58,  84,  94,  98, 154, 179, 196]), 25: array([ 350,  404,  470, 1345, 1634, 1667, 1699, 1716, 1736, 1778]), 26: array([ 17,  39,  55,  76,  91, 117, 119, 147, 197, 206]), 27: array([  4,  24, 108, 139, 267, 273, 314, 338, 352, 434]), 28: array([ 2,  9, 12, 20, 22, 23, 27, 28, 44, 47]), 29: array([  89,  262,  450, 1476, 1576, 1630, 1759, 2141, 2345, 3644]), 30: array([191, 232, 233, 234, 305, 322, 331, 336, 337, 354]), 31: array([ 52, 102, 145, 205, 223, 309, 329, 460, 485, 868]), 32: array([ 166,  183,  247,  418, 1040, 4204, 4368, 6079, 6571, 6714]), 33: array([ 15,  25,  70,  93, 103, 194, 255, 377, 388, 875]), 34: array([  5,  16,  26,  67,  88,  92, 106, 126, 167, 177]), 35: array([ 1642,  2923,  5297,  5395,  6615,  7213,  8001, 11870, 13985,
       23875]), 36: array([ 11,  74,  81, 137, 164, 182, 220, 340, 887, 950]), 37: array([ 241,  278,  935, 1007, 1024, 1050, 1326, 1401, 1445, 1559]), 38: array([ 51, 130, 138, 141, 328, 403, 481, 803, 826, 922]), 39: array([ 73, 201, 210, 231, 254, 412, 862, 932, 969, 971])}
{0: array([  36,   96,  353, 1669, 2668, 2943, 3404, 3912, 4240, 5242]), 1: array([ 186,  193,  200,  374, 1657, 2229, 2357, 2811, 3415, 5310]), 2: array([ 43,  79, 110, 149, 153, 157, 192, 209, 237, 257]), 3: array([  8,  29,  40,  83, 213, 266, 288, 458, 880, 946]), 4: array([  0,   7,  30,  53,  85, 112, 125, 134, 162, 215]), 5: array([  1,  56,  63,  69,  97, 174, 245, 330, 373, 392]), 6: array([   6,  100,  219,  310,  448,  454,  988,  996, 1489, 1658]), 7: array([ 195,  226,  815,  834, 1017, 1331, 1349, 1378, 1446, 1462]), 8: array([  3,  33,  41,  62, 109, 120, 121, 133, 163, 168]), 9: array([ 60,  61,  66, 181, 275, 848, 851, 854, 889, 915]), 10: array([ 32, 101, 104, 129, 146, 224, 230, 235, 246, 290]), 11: array([  87,  144,  251, 1413, 1478, 2204, 2756, 4066, 4069, 4123]), 12: array([28709, 33497, 47486, 49324, 53177, 57175, 65874, 66545, 84236,
       92632]), 13: array([  77,  260,  268,  270,  302, 1375, 1397, 1484, 1504, 1508]), 14: array([  21,  135,  184,  837, 1425, 1491, 2639, 2644, 2670, 2826]), 15: array([1577, 1647, 1746, 2215, 3602, 3928, 4275, 4834, 4917, 5384]), 16: array([ 14,  31,  34,  38,  64,  75, 123, 127, 128, 221]), 17: array([1439, 2178, 2312, 3056, 3615, 4847, 5236, 6122, 6586, 7731]), 18: array([  48,  298, 1008, 1500, 2119, 2631, 2891, 4837, 5213, 5281]), 19: array([ 19,  46,  82, 116, 142, 143, 178, 180, 202, 263]), 20: array([ 42,  59, 211, 242, 269, 423, 439, 446, 819, 883]), 21: array([ 190,  466,  867, 1338, 1421, 1646, 2164, 2652, 2666, 2747]), 22: array([ 13,  35,  45, 115, 148, 161, 225, 243, 402, 441]), 23: array([ 86, 114, 140, 150, 159, 172, 198, 335, 436, 865]), 24: array([ 10,  18,  37,  58,  84,  94,  98, 154, 179, 196]), 25: array([ 350,  404,  470, 1345, 1634, 1667, 1699, 1716, 1736, 1778]), 26: array([ 17,  39,  55,  76,  91, 117, 119, 147, 197, 206]), 27: array([  4,  24, 108, 139, 267, 273, 314, 338, 352, 434]), 28: array([ 2,  9, 12, 20, 22, 23, 27, 28, 44, 47]), 29: array([  89,  262,  450, 1476, 1576, 1630, 1759, 2141, 2345, 3644]), 30: array([191, 232, 233, 234, 305, 322, 331, 336, 337, 354]), 31: array([ 52, 102, 145, 205, 223, 309, 329, 460, 485, 868]), 32: array([ 166,  183,  247,  418, 1040, 4204, 4368, 6079, 6571, 6714]), 33: array([ 15,  25,  70,  93, 103, 194, 255, 377, 388, 875]), 34: array([  5,  16,  26,  67,  88,  92, 106, 126, 167, 177]), 35: array([ 1642,  2923,  5297,  5395,  6615,  7213,  8001, 11870, 13985,
       23875]), 36: array([ 11,  74,  81, 137, 164, 182, 220, 340, 887, 950]), 37: array([ 241,  278,  935, 1007, 1024, 1050, 1326, 1401, 1445, 1559]), 38: array([ 51, 130, 138, 141, 328, 403, 481, 803, 826, 922]), 39: array([ 73, 201, 210, 231, 254, 412, 862, 932, 969, 971])}
  0%|                                                                                                                                                                                                                                                   | 0/510 [00:00<?, ?it/s]












 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 466/500 [00:24<00:01, 25.07it/s]
Evaluation only - skipping training - exiting now

Note: also skipping evaluation of val set